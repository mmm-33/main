import{c as R,i as g,g as ae,b as d,F as ie,V as x,u as Y,r as m,j as e,B as ne,L as H,O as oe,C as le,S as ce,P as de,e as me}from"./index-CDJvYQCk.js";import{u as pe,P as ue}from"./PhoneInput-BkcUG8oG.js";import{S as ge}from"./SEOHead-B491tj0c.js";import{u as xe,a as he,C as O}from"./stripe.esm-CJ7_xW5N.js";import{C as L}from"./credit-card-D9xZZh1s.js";import{C}from"./check-circle-B6Ayj0vX.js";import{S as ye,s as fe}from"./StripeProvider-Dj6iZCs8.js";import{C as be}from"./calendar-Cv4FbU3y.js";import{U as je}from"./users-DJdzvLLE.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=R("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=R("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=R("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=R("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),M={async createOrUpdateClient(t){try{console.log("Creating/updating client in CRM:",t);const{data:s,error:r}=await d.from("clients").select("*").eq("email",t.email).limit(1);if(r)throw console.error("Error finding client in CRM:",r),r;const a=s&&s.length>0?s[0]:null;if(a){const{data:n,error:i}=await d.from("clients").update({name:`${t.firstName} ${t.lastName}`,phone:t.phone,language:t.language||"en",lead_source:t.leadSource||"website",updated_at:new Date().toISOString()}).eq("id",a.id).select().maybeSingle();if(i)throw console.error("Error updating client in CRM:",i),i;return console.log("Client updated in CRM:",n),n||(console.error("Client update failed - no record found"),null)}else{const n=this.generatePortalToken(),{data:i,error:c}=await d.from("clients").insert({name:`${t.firstName} ${t.lastName}`,email:t.email,phone:t.phone,language:t.language||"en",segment:"new",total_bookings:0,total_spent:0,lead_source:t.leadSource||"website",portal_access:!0,portal_token:n}).select().single();if(c)throw console.error("Error creating client in CRM:",c),c;return console.log("New client created in CRM:",i),await this.logSyncOperation("clients","create",i.id),i}}catch(s){return console.error("CRM client creation/update failed:",s),await this.logError("createOrUpdateClient",s),null}},async createBooking(t){try{if(console.log("Creating booking in CRM:",t),!g(t.clientId))throw new Error(`Invalid client ID: ${t.clientId}`);if(t.yachtId&&!g(t.yachtId))throw new Error(`Invalid yacht ID: ${t.yachtId}`);const{data:s,error:r}=await d.from("bookings").insert({client_id:t.clientId,yacht_id:t.yachtId,session_date:t.sessionDate,session_time:t.sessionTime,status:"pending",payment_status:"pending",amount:t.amount,notes:t.specialRequests}).select().single();if(r)throw console.error("Error creating booking in CRM:",r),r;return console.log("Booking created in CRM:",s),await this.updateClientStats(t.clientId,t.amount),await this.logSyncOperation("bookings","create",s.id),await this.createBookingNotification(s.id,t.clientId),s}catch(s){return console.error("CRM booking creation failed:",s),await this.logError("createBooking",s),null}},async generateClientPortalAccess(t){try{if(!g(t))throw new Error(`Invalid client ID: ${t}`);const{data:s,error:r}=await d.from("clients").select("*").eq("id",t).maybeSingle();if(r)throw console.error("Error fetching client for portal access:",r),r;if(!s)return console.error("Client not found for portal access generation"),null;const a=s.portal_token||this.generatePortalToken();if(!s.portal_access||!s.portal_token){const{error:c}=await d.from("clients").update({portal_access:!0,portal_token:a}).eq("id",t);if(c)throw console.error("Error updating client portal access:",c),c}const n=new Date;n.setDate(n.getDate()+30);const i=`${ie}portal?token=${a}`;return{token:a,url:i,expiresAt:n}}catch(s){return console.error("Failed to generate client portal access:",s),await this.logError("generateClientPortalAccess",s),null}},async updateClientStats(t,s){try{if(!g(t))throw new Error(`Invalid client ID: ${t}`);const{data:r,error:a}=await d.from("clients").select("total_bookings, total_spent, segment").eq("id",t).single();if(a)throw console.error("Error fetching client for stats update:",a),a;const n=(r.total_bookings||0)+1,i=(r.total_spent||0)+s;let c=r.segment||"new";n>=5||i>=1e3?c="vip":n>=2&&(c="active");const{error:o}=await d.from("clients").update({total_bookings:n,total_spent:i,last_booking:new Date().toISOString(),segment:c,updated_at:new Date().toISOString()}).eq("id",t);if(o)throw console.error("Error updating client stats:",o),o;console.log("Client stats updated:",{clientId:t,totalBookings:n,totalSpent:i,segment:c})}catch(r){console.error("Failed to update client stats:",r),await this.logError("updateClientStats",r)}},async createBookingNotification(t,s){try{if(!g(t))throw new Error(`Invalid booking ID: ${t}`);if(!g(s))throw new Error(`Invalid client ID: ${s}`);const{data:r,error:a}=await d.from("clients").select("email, name").eq("id",s).single();if(a)throw console.error("Error fetching client for notification:",a),a;const{error:n}=await d.from("notifications").insert({type:"booking_created",title:"New Booking Created",message:`A new booking has been created for ${r.name}`,recipient_id:s,recipient_email:r.email,channel:"email",status:"pending",booking_id:t});if(n)throw console.error("Error creating notification:",n),n;console.log("Booking notification created for:",{bookingId:t,clientId:s})}catch(r){console.error("Failed to create booking notification:",r),await this.logError("createBookingNotification",r)}},async logSyncOperation(t,s,r){try{r&&!g(r)&&console.warn(`Non-UUID record ID provided for sync log: ${r}`),await d.from("sync_logs").insert({table_name:t,operation:s,record_id:r,sync_status:"success",synced_at:new Date().toISOString()})}catch(a){console.error("Failed to log sync operation:",a)}},async logError(t,s){try{await d.from("error_logs").insert({action:t,error_message:s.message||String(s),error_stack:s.stack,context:{timestamp:new Date().toISOString()},user_agent:navigator.userAgent})}catch(r){console.error("Failed to log error:",r)}},generatePortalToken(){return ae()},validateClientData(t){const s=[];return(!t.firstName||t.firstName.trim()==="")&&s.push("First name is required"),(!t.lastName||t.lastName.trim()==="")&&s.push("Last name is required"),!t.email||t.email.trim()===""?s.push("Email is required"):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||s.push("Email format is invalid"),(!t.phone||t.phone.trim()==="")&&s.push("Phone number is required"),s},validateBookingData(t){const s=[];if(t.clientId?g(t.clientId)||s.push("Client ID must be a valid UUID"):s.push("Client ID is required"),t.yachtId&&!g(t.yachtId)&&s.push("Yacht ID must be a valid UUID"),!t.sessionDate)s.push("Session date is required");else{const r=new Date(t.sessionDate),a=new Date,n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),i=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));n<i&&s.push("Session date cannot be in the past")}return t.sessionTime||s.push("Session time is required"),(t.participants<1||t.participants>8)&&s.push("Participants must be between 1 and 8"),t.amount<=0&&s.push("Amount must be greater than zero"),s}},W={async createBooking(t){var s,r;try{console.log("Creating booking with data:",t);const a=t.participants*199,n=t.paymentMethod==="deposit"?t.depositAmount||Math.round(a*.3):a,i={firstName:t.firstName,lastName:t.lastName,email:t.email,phone:t.phone,language:d.auth.getSession()&&((r=(s=(await d.auth.getSession()).data.session)==null?void 0:s.user.app_metadata)==null?void 0:r.language)||"en",leadSource:"website"},c=M.validateClientData(i);if(c.length>0)return c.forEach(y=>x.error(y)),null;const o=await M.createOrUpdateClient(i);if(!o)return x.error("Failed to create or update client in CRM. Please try again."),null;console.log("Client created/retrieved:",o);const u=await this.getAvailableYacht(t.bookingDate);console.log("Available yacht:",u);const h={clientId:o.id,sessionDate:t.bookingDate,sessionTime:t.timeSlot,participants:t.participants,amount:a,specialRequests:t.specialRequests,yachtId:u==null?void 0:u.id},N=M.validateBookingData(h);if(N.length>0)return N.forEach(y=>x.error(y)),null;const p=await M.createBooking(h);if(!p)return x.error("Failed to create booking in CRM. Please try again."),null;u&&await this.updateYachtStatus(u.id,"booked",t.bookingDate);const w=await M.generateClientPortalAccess(o.id);w&&console.log("Client portal access generated:",w);const b=await this.getBookingWithDetails(p.id);if(!b){const y={...p,client:o,yacht:u};return x.success("Booking created successfully! Check your email for confirmation."),y}return t.paymentMethod==="card"&&b&&(await this.updateBookingStatus(b.id,"confirmed"),await this.updatePaymentStatus(b.id,"paid")),x.success("Booking created successfully! Check your email for confirmation."),b}catch(a){return console.error("Error in createBooking:",a),x.error("An unexpected error occurred. Please try again."),null}},async getAvailableYacht(t){try{const{data:s,error:r}=await d.from("yachts").select("id, name").eq("status","available").limit(1);return r?(console.log("No available yacht found or error:",r),null):s&&s.length>0?s[0]:null}catch(s){return console.error("Error getting available yacht:",s),null}},async updateYachtStatus(t,s,r){try{if(!g(t))throw new Error(`Invalid yacht ID: ${t}`);const a={status:s};r&&(a.next_booking=r);const{error:n}=await d.from("yachts").update(a).eq("id",t);n&&console.error("Error updating yacht status:",n)}catch(a){console.error("Error in updateYachtStatus:",a)}},async getBookingWithDetails(t){try{if(!g(t))throw new Error(`Invalid booking ID: ${t}`);const{data:s,error:r}=await d.from("bookings").select(`
          *,
          client:clients(*),
          yacht:yachts(id, name)
        `).eq("id",t);return r?(console.error("Error fetching booking:",r),null):(s==null?void 0:s[0])||null}catch(s){return console.error("Error in getBooking:",s),null}},async updateBookingStatus(t,s){try{if(!g(t))throw new Error(`Invalid booking ID: ${t}`);const{error:r}=await d.from("bookings").update({status:s,updated_at:new Date().toISOString()}).eq("id",t);return r?(console.error("Error updating booking status:",r),!1):!0}catch(r){return console.error("Error in updateBookingStatus:",r),!1}},async updatePaymentStatus(t,s){try{if(!g(t))throw new Error(`Invalid booking ID: ${t}`);const{error:r}=await d.from("bookings").update({payment_status:s,updated_at:new Date().toISOString()}).eq("id",t);return r?(console.error("Error updating payment status:",r),!1):!0}catch(r){return console.error("Error in updatePaymentStatus:",r),!1}},validateBookingForm(t){const s=[];t.firstName.trim()||s.push("First name is required"),t.lastName.trim()||s.push("Last name is required"),t.email.trim()||s.push("Email is required"),t.phone.trim()||s.push("Phone number is required"),t.bookingDate||s.push("Booking date is required"),t.timeSlot||s.push("Time slot is required"),(t.participants<1||t.participants>8)&&s.push("Participants must be between 1 and 8"),t.agreeTerms||s.push("You must agree to the terms and conditions");const r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;t.email&&!r.test(t.email)&&s.push("Please enter a valid email address"),t.phone||s.push("Phone number is required"),t.paymentMethod==="card"&&!t.paymentSucceeded&&s.push("Payment must be completed");const a=new Date(t.bookingDate),n=new Date;return new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)),new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)),a<n&&s.push("Booking date must be in the future"),s}},ve={style:{base:{color:"#32325d",fontFamily:'"Inter", sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},hidePostalCode:!0},Se=({clientSecret:t,amount:s,currency:r="EUR",onSuccess:a,onError:n})=>{const{t:i}=Y(),c=xe(),o=he(),[u,h]=m.useState(null),[N,p]=m.useState(!1),[w,b]=m.useState(!1),[y,B]=m.useState(!1),[D,_]=m.useState("");m.useEffect(()=>{},[c]);const A=async f=>{var q;if(f.preventDefault(),!(!c||!o)){if(u){(q=o.getElement(O))==null||q.focus();return}if(!N){h(i("payment.incompleteCard","Please complete your card details"));return}if(!D){h(i("payment.nameRequired","Cardholder name is required"));return}b(!0);try{const k=await c.confirmCardPayment(t,{payment_method:{card:o.getElement(O),billing_details:{name:D}}});k.error?(h(k.error.message||"An error occurred with your payment"),n==null||n(new Error(k.error.message||"Payment failed"))):(h(null),B(!0),a==null||a(k.paymentIntent))}catch(k){h("An unexpected error occurred"),n==null||n(k)}finally{b(!1)}}},U=(f,q)=>new Intl.NumberFormat("en-US",{style:"currency",currency:q.toUpperCase()}).format(f);return e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(L,{className:"h-6 w-6 text-blue-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:i("booking.secureProcessing")}),e.jsx("p",{className:"text-blue-800 text-sm",children:i("booking.secureProcessingDescription")})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cardholderName",className:"block text-sm font-semibold text-gray-900 mb-2",children:i("booking.cardholderName")}),e.jsx("input",{id:"cardholderName",type:"text",value:D,onChange:f=>_(f.target.value),placeholder:"John Doe",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",disabled:w||y})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"card-element",className:"block text-sm font-semibold text-gray-900 mb-2",children:i("booking.cardNumber")}),e.jsx("div",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus-within:ring-2 focus-within:ring-primary-500 focus-within:border-transparent bg-white",children:e.jsx(O,{id:"card-element",options:ve,onChange:f=>{h(f.error?f.error.message:""),p(f.complete)}})})]})]}),u&&e.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(G,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-red-800 text-sm",children:u})]})}),y&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(C,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-green-800 text-sm",children:i("payment.success","Payment successful!")})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-gray-700",children:[e.jsxs("span",{className:"text-sm",children:[i("booking.total"),":"]}),e.jsx("span",{className:"ml-2 font-semibold text-lg",children:U(s,r)})]}),e.jsx(ne,{type:"submit",variant:"primary",size:"lg",disabled:w||y||!c||!N,loading:w,children:w?i("booking.processing"):y?i("payment.paid","Paid"):i("payment.pay","Pay")+" "+U(s,r)})]})]})},Ce=({onSelect:t,selectedMethod:s="card"})=>{const{t:r}=Y(),[a,n]=m.useState(s),i=[{id:"card",name:r("payment.creditCard","Credit Card"),icon:e.jsx(L,{className:"h-5 w-5"}),description:r("payment.creditCardDesc","Pay securely with your credit or debit card")},{id:"deposit",name:r("payment.deposit","Pay Deposit"),icon:e.jsx(Ne,{className:"h-5 w-5"}),description:r("payment.depositDesc","Pay 30% now and the rest on the day")},{id:"wallet",name:r("payment.wallet","Digital Wallet"),icon:e.jsx(ke,{className:"h-5 w-5"}),description:r("payment.walletDesc","Pay with Apple Pay or Google Pay")}],c=o=>{n(o),t(o)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:r("payment.selectMethod","Select Payment Method")}),e.jsx("div",{className:"space-y-3",children:i.map(o=>e.jsxs("div",{className:`flex items-start p-4 border-2 rounded-lg cursor-pointer transition-colors duration-200 ${a===o.id?"border-primary-600 bg-primary-50":"border-gray-200 hover:border-primary-300 hover:bg-gray-50"}`,onClick:()=>c(o.id),children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{id:`payment-${o.id}`,name:"payment-method",type:"radio",checked:a===o.id,onChange:()=>c(o.id),className:"h-4 w-4 text-primary-600 border-gray-300 focus:ring-primary-500"})}),e.jsxs("div",{className:"ml-3 flex items-center",children:[e.jsx("div",{className:`p-2 rounded-full mr-3 ${a===o.id?"bg-primary-100":"bg-gray-100"}`,children:o.icon}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`payment-${o.id}`,className:"font-medium text-gray-900",children:o.name}),e.jsx("p",{className:"text-sm text-gray-500",children:o.description})]})]})]},o.id))})]})},Te=()=>{const{t}=Y(),[s,r]=m.useState(1),[a,n]=m.useState(""),[i,c]=m.useState(""),[o,u]=m.useState(1),[h,N]=m.useState(!1),[p,w]=m.useState("card"),[b,y]=m.useState(!1),[B,D]=m.useState(null),[_,A]=m.useState(null),[U,f]=m.useState(!1),[q,k]=m.useState(!1),{register:I,handleSubmit:J,watch:Z,control:K,formState:{errors:v}}=pe({defaultValues:{participants:1,agreeTerms:!1,agreeMarketing:!1}}),$=Z(),Q=[{time:"08:30",available:!0,price:199},{time:"09:00",available:!0,price:199},{time:"13:30",available:!1,price:199},{time:"14:00",available:!0,price:199}],P=o*199,S=Math.round(P*.3);m.useEffect(()=>{(async()=>{if(s===3&&!_&&p==="card")try{f(!0);const j=p==="deposit"?S:P,{clientSecret:T}=await fe.createPaymentIntent({amount:j,currency:"eur",description:`Booking for ${a} at ${i} - ${o} participants`,metadata:{bookingDate:a,timeSlot:i,participants:o.toString()}});A(T)}catch(j){console.error("Error creating payment intent:",j),x.error(t("payment.intentError","Failed to initialize payment. Please try again."))}finally{f(!1)}})()},[s,_,p,S,P,a,i,o,t]);const X=()=>{s<3&&r(s+1)},ee=()=>{s>1&&r(s-1)},F=()=>{switch(s){case 1:return a&&i&&o>0;case 2:return $.firstName&&$.lastName&&$.email&&$.phone&&$.agreeTerms;case 3:return q||p==="deposit";default:return!0}},te=l=>{k(!0),x.success(t("payment.success","Payment successful!"))},se=l=>{x.error(l.message||t("payment.error","Payment failed. Please try again."))},re=async l=>{var V;N(!0);const j={...l,bookingDate:a,timeSlot:i,participants:o};j.paymentMethod=p,j.depositAmount=S;const T=W.validateBookingForm(j);if(T.length>0){T.forEach(E=>x.error(E)),N(!1);return}try{const E=await W.createBooking(j);if(E){if(x.success(t("booking.success")),(V=E.client)!=null&&V.id){const z=await M.generateClientPortalAccess(E.client.id);z&&D(z.url)}y(!0)}}catch(E){console.error("Booking error:",E),x.error(t("booking.error"))}finally{N(!1)}};return b?e.jsx("div",{className:"pt-20 min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(C,{className:"h-8 w-8 text-green-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:t("booking.success")}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Check your email for booking confirmation and details."}),B&&e.jsx("a",{href:B,target:"_blank",rel:"noopener norefferer",className:"block w-full bg-primary-600 text-white py-3 rounded-lg font-semibold hover:bg-primary-700 transition-colors duration-300 mb-4",children:"Access Your Client Portal"}),e.jsx(H,{to:"/",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Return to Home"})]})}):e.jsxs("div",{className:"pt-20 min-h-screen bg-gray-50",children:[e.jsx(oe,{position:"top-right"}),e.jsx(ge,{title:t("booking.title"),description:t("booking.subtitle"),url:"/booking"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4 font-serif",children:t("booking.title")}),e.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:t("booking.subtitle")})]}),e.jsx("div",{className:"max-w-3xl mx-auto mb-12",children:e.jsx("div",{className:"flex items-center justify-between",children:[{step:1,title:t("booking.steps.dateTime"),icon:be},{step:2,title:t("booking.steps.details"),icon:je},{step:3,title:t("booking.steps.payment"),icon:L}].map((l,j)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full border-2 transition-colors duration-300 ${s>=l.step?"bg-primary-600 border-primary-600 text-white":"border-gray-300 text-gray-400"}`,children:s>l.step?e.jsx(C,{className:"h-6 w-6"}):e.jsx(l.icon,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4 hidden sm:block",children:[e.jsxs("p",{className:`font-semibold ${s>=l.step?"text-primary-600":"text-gray-400"}`,children:[t("common.step")," ",l.step]}),e.jsx("p",{className:`text-sm ${s>=l.step?"text-gray-900":"text-gray-500"}`,children:l.title})]}),j<2&&e.jsx("div",{className:`hidden sm:block w-24 h-1 mx-4 rounded ${s>l.step?"bg-primary-600":"bg-gray-300"}`})]},l.step))})}),e.jsx("form",{onSubmit:J(re),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[s===1&&e.jsxs("div",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:t("booking.selectExperience")}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:t("booking.chooseDate")}),e.jsx("input",{type:"date",value:a,onChange:l=>n(l.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent text-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:t("booking.chooseTime")}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Q.map(l=>e.jsxs("button",{type:"button",onClick:()=>l.available&&c(l.time),disabled:!l.available,className:`p-4 rounded-lg border-2 transition-all duration-300 ${i===l.time?"border-primary-600 bg-primary-50 text-primary-600":l.available?"border-gray-300 hover:border-primary-300 hover:bg-primary-50":"border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx("div",{className:"text-xl font-semibold",children:l.time}),e.jsx("div",{className:"text-sm",children:l.available?`€${l.price} ${t("booking.pricePerPerson")}`:t("booking.fullyBooked")})]},l.time))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:t("booking.participants")}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>u(Math.max(1,o-1)),className:"w-12 h-12 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors duration-300 flex items-center justify-center text-xl font-semibold",children:"-"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900 min-w-[3rem] text-center",children:o}),e.jsx("button",{type:"button",onClick:()=>u(Math.min(8,o+1)),className:"w-12 h-12 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors duration-300 flex items-center justify-center text-xl font-semibold",children:"+"}),e.jsx("span",{className:"text-gray-600 ml-4",children:t("booking.maxParticipants")})]})]})]}),s===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:t("booking.yourDetails")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:[t("booking.firstName")," *"]}),e.jsx("input",{type:"text",...I("firstName",{required:t("forms.required")}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),v.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:v.firstName.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:[t("booking.lastName")," *"]}),e.jsx("input",{type:"text",...I("lastName",{required:t("forms.required")}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),v.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:v.lastName.message})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:[t("booking.email")," *"]}),e.jsx("input",{type:"email",...I("email",{required:t("forms.required"),pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:t("forms.invalidEmail")}}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),v.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:v.email.message})]}),e.jsx("div",{children:e.jsx(ue,{name:"phone",control:K,label:t("booking.phone"),error:v.phone,required:!0})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:t("booking.specialRequests")}),e.jsx("textarea",{...I("specialRequests"),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:t("booking.specialRequestsPlaceholder")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",...I("agreeTerms",{required:t("booking.agreeTermsRequired")}),className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsxs("label",{className:"text-sm text-gray-700",children:[t("booking.agreeTerms")," ",e.jsx(H,{to:"/terms-of-service",className:"text-primary-600 hover:underline",children:t("navigation.terms")})," *"]})]}),v.agreeTerms&&e.jsx("p",{className:"text-sm text-red-600",children:v.agreeTerms.message}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",...I("agreeMarketing"),className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"text-sm text-gray-700",children:t("booking.agreeMarketing")})]})]})]}),s===3&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx(we,{className:"h-6 w-6 text-primary-600"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t("booking.securePayment")})]}),e.jsx(Ce,{onSelect:w,selectedMethod:p}),p==="card"&&e.jsx(ye,{children:_?e.jsx(Se,{clientSecret:_,amount:P,onSuccess:te,onError:se}):e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:t("payment.initializing","Initializing payment...")})]})}),p==="deposit"&&e.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(G,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:t("payment.depositInfo","Deposit Payment")}),e.jsx("p",{className:"text-yellow-800 text-sm",children:t("payment.depositDesc","You will pay a deposit of {{amount}} now and the remaining {{remaining}} on the day of your experience.",{amount:`€${S}`,remaining:`€${P-S}`})}),e.jsx("button",{type:"button",onClick:()=>k(!0),className:"mt-4 bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors duration-300",children:t("payment.confirmDeposit","Confirm Deposit Payment")})]})]})}),p==="wallet"&&e.jsx("div",{className:"bg-blue-50 p-6 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Wallet,{className:"h-6 w-6 text-blue-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:t("payment.walletInfo","Digital Wallet")}),e.jsx("p",{className:"text-blue-800 text-sm",children:t("payment.walletDesc","Digital wallet payment will be available soon. Please select another payment method.")})]})]})}),e.jsx("div",{className:"bg-green-50 p-6 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(C,{className:"h-6 w-6 text-green-600 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:t("booking.whatHappensAfter")}),e.jsxs("ul",{className:"text-green-800 text-sm space-y-1",children:[e.jsxs("li",{children:["• ",t("booking.instantConfirmation")]}),e.jsxs("li",{children:["• ",t("booking.meetingPoint")]}),e.jsxs("li",{children:["• ",t("booking.weatherUpdates")]}),e.jsxs("li",{children:["• ",t("booking.photosDelivered")]}),e.jsx("li",{className:"font-semibold",children:"• Access to your personal client portal"})]})]})]})})]}),e.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:ee,className:`px-6 py-3 rounded-lg font-semibold transition-colors duration-300 ${s===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:s===1,children:t("common.previous")}),s<3?e.jsx("button",{type:"button",onClick:X,disabled:!F(),className:`px-8 py-3 rounded-lg font-semibold transition-all duration-300 ${F()?"bg-primary-600 text-white hover:bg-primary-700 hover:scale-105":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:t("common.next")}):e.jsx("button",{type:"submit",disabled:h||s===3&&!F(),className:"bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:t("booking.processing")})]}):e.jsx("span",{children:t("booking.completeBooking")})})]})]})}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sticky top-32",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:t("booking.bookingSummary")}),e.jsxs("div",{className:"space-y-4 mb-6",children:[a&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:t("booking.date")}),e.jsx("span",{className:"font-semibold",children:new Date(a).toLocaleDateString()})]}),i&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:t("booking.time")}),e.jsx("span",{className:"font-semibold",children:i})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600",children:[t("booking.participants"),":"]}),e.jsx("span",{className:"font-semibold",children:o})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600",children:[t("booking.pricePerPerson"),":"]}),e.jsx("span",{className:"font-semibold",children:"€199"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsxs("span",{children:[t("booking.total"),":"]}),e.jsxs("span",{className:"text-primary-600",children:["€",p==="deposit"?S:P]})]}),p==="deposit"&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:t("booking.deposit",{deposit:S,remaining:P-S})})]}),e.jsxs("div",{className:"space-y-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("features.professionalSkipper.title")})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("booking.safetyEquipment")})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("booking.medalCertificate")})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("features.photosIncluded.title")})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:t("booking.freeCancellation")})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:t("features.fullyInsured.title")})]})]})]}),e.jsxs("div",{className:"bg-primary-50 rounded-2xl p-6 mt-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:t("booking.needHelp")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:"tel:+393456789012",className:"flex items-center space-x-3 text-primary-600 hover:text-primary-700 transition-colors duration-300",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{children:"+39 345 678 9012"})]}),e.jsxs("a",{href:"mailto:info@gardaracing.com",className:"flex items-center space-x-3 text-primary-600 hover:text-primary-700 transition-colors duration-300",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:"info@gardaracing.com"})]})]})]})]})]})})]})]})};export{Te as default};
